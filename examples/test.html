<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset=utf-8>
        <meta name="viewport" content="width=620">
        <title>HTML5 Demo: File API (simple)</title>
        <!--        <link rel="stylesheet" href="css/html5demos.css">-->
        <script src="http://html5demos.com/js/h5utils.js"></script></head>
    <body>
        <section id="wrapper">
            <header>
                <h1>File API (simple)</h1>
            </header>

            <article>
                <p id="status">File API & FileReader API not supported</p>
                <p><input type=file></p>
                <p>Select an image from your machine to read the contents of the file without using a server</p>
                <div id="holder">hier plaatje</div>
            </article>
            <script>
                var upload = document.getElementsByTagName('input')[0],
                holder = document.getElementById('holder');

                
                upload.onchange = function (e) {
                    e.preventDefault();

                    function addImage(data){
                        var img = new Image();
                        img.src = data;
                        // note: no onload required since we've got the dataurl...I think! :)
                        if (img.width > 560) { // holder width
                            img.width = 560;
                        }
                        holder.innerHTML = '';
                        holder.appendChild(img);
                         
                    }

                    var file = upload.files[0],
                    reader = new FileReader();

                    reader.onerror = function(error){
                        //console.log(error.target.error.code);
                        addImage(event.target.result);
                    }
                    
                    reader.onload = function (event) {
                        addImage(event.target.result);
                    };
 
 
                    reader.readAsDataURL(file);

                    return false;
                };
            </script>
        </section>
    </body>
</html>